<?xml version='1.0' encoding='ASCII'?>
<ccp4i2>
  <ccp4i2_header>
    <function>DEF</function>
    <userId>martin</userId>
    <hostName>precision</hostName>
    <creationTime>2023-09-12T14:24:01.291479</creationTime>
    <pluginVersion/>
    <ccp4iVersion>0.0.1</ccp4iVersion>
    <pluginName>xia2_ssx_reduce</pluginName>
    <OS>linux</OS>
    <jobId/>
  </ccp4i2_header>
  <ccp4i2_body id="xia2_ssx_reduce">
    <container id="inputData">
      <content id="SEARCH_ROOT_DIR">
        <className>CDataFile</className>
        <qualifiers>
          <mustExist>True</mustExist>
          <allowUndefined>True</allowUndefined>
          <isDirectory>True</isDirectory>
          <guiLabel>Root directory</guiLabel>
          <toolTip>Start search from this directory</toolTip>
        </qualifiers>
      </content>
      <content id="DIALS_INTEGRATED">
        <className>CList</className>
        <qualifiers>
          <guiLabel>DIALS .refl</guiLabel>
          <toolTip>Must have an associated .expt file</toolTip>
          <listMinLength>1</listMinLength>
        </qualifiers>
        <subItem>
          <className>CDataFile</className>
          <qualifiers>
            <saveToDb>False</saveToDb>
            <mustExist>True</mustExist>
            <allowUndefined>True</allowUndefined>
            <isDirectory>False</isDirectory>
            <guiLabel>Bar</guiLabel>
            <toolTip>Foo</toolTip>
          </qualifiers>
        </subItem>
      </content>
      <content id="XIA2_RUN">
        <className>CList</className>
        <qualifiers>
          <guiLabel>Previous xia2 run directories</guiLabel>
          <listMinLength>2</listMinLength>
        </qualifiers>
        <subItem>
          <className>CDataFile</className>
          <qualifiers>
            <mustExist>True</mustExist>
            <allowUndefined>True</allowUndefined>
            <isDirectory>True</isDirectory>
            <guiLabel>Path to a previous xia2 run directory (containing a DataFiles sub-directory)</guiLabel>
            <toolTip>Integration files will be automatically extracted from a previous xia2 run</toolTip>
          </qualifiers>
        </subItem>
      </content>
      <content id="SEARCH_PREFERENCE">
        <className>CString</className>
        <qualifiers>
          <onlyEnumerators>True</onlyEnumerators>
          <guiLabel>Search for</guiLabel>
          <toolTip></toolTip>
          <guiDefinition>
            <expertLevel>1</expertLevel>
          </guiDefinition>
             <menuText>integrated.refl, scaled.refl</menuText>
             <enumerators>integrated,scaled</enumerators>
             <default>integrated</default>
          </qualifiers>
        </content>
      <qualifiers/>
    </container>
    <container id="outputData">
      <content id="HKLOUT">
        <className>CList</className>
        <qualifiers/>
        <subItem>
          <className>CObsDataFile</className>
          <qualifiers>
            <default/>
            <contentFlag>
              <min>0</min>
            </contentFlag>
            <subType>
              <menuText>observed data,derived data,reference data</menuText>
              <onlyEnumerators>True</onlyEnumerators>
              <enumerators>1,2,3</enumerators>
              <default>1</default>
            </subType>
          </qualifiers>
        </subItem>
      </content>
      <content id="PERFORMANCE">
        <className>CDataReductionPerformance</className>
        <qualifiers/>
      </content>
      <qualifiers/>
    </container>
    <container id="controlParameters">
      <container id="input">
        <qualifiers>
          <guiDefinition/>
        </qualifiers>
      </container>
      <container id="workflow">
        <qualifiers>
          <guiDefinition/>
        </qualifiers>
        <content id="workflow__steps">
          <className>CString</className>
          <qualifiers>
            <onlyEnumerators>True</onlyEnumerators>
            <guiLabel>Workflow</guiLabel>
            <toolTip>Option to control either full reduction (steps=scale+merge) or just merging already scaled data (steps=merge).</toolTip>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
               <menuText>scale and merge, not scale just merge</menuText>
               <enumerators>scale+merge,merge</enumerators>
               <default>scale+merge</default>
          </qualifiers>
        </content>
      </container>
      <content id="grouping">
        <className>CDataFile</className>
        <qualifiers>
          <guiLabel>Grouping .yml file</guiLabel>
          <toolTip>Path to a .yml file defining grouping structure during processing</toolTip>
          <guiDefinition/>
        </qualifiers>
      </content>
      <content id="multiprocessing__nproc">
        <className>CInt</className>
        <qualifiers>
          <guiLabel>Number of processors for multiprocessing</guiLabel>
          <guiDefinition>
            <expertLevel>1</expertLevel>
          </guiDefinition>
          <default>Auto</default>
        </qualifiers>
      </content>
      <content id="d_min">
        <className>CFloat</className>
        <qualifiers>
          <guiLabel>High resolution cutoff</guiLabel>
          <guiDefinition>
            <expertLevel>1</expertLevel>
          </guiDefinition>
          <default>None</default>
        </qualifiers>
      </content>
      <content id="dials_cosym_phil_d_min">
        <className>CFloat</className>
        <qualifiers>
          <guiLabel>High resolution cutoff for dials.cosym</guiLabel>
          <guiDefinition>
            <expertLevel>1</expertLevel>
          </guiDefinition>
          <default>None</default>
        </qualifiers>
      </content>
      <content id="dose_series_repeat">
        <className>CInt</className>
        <qualifiers>
          <guiLabel>Dose series - number of repeated measurements at each point</guiLabel>
          <toolTip>This option allows the user to specify that the data is a dose series by providing the number of repeated measurements at each point. i.e. it is assumed that $dose_series_repeat measurements are taken on each crystal and that these form consecutive images in the input image files. Each dose point will be merged separately</toolTip>
          <guiDefinition>
            <expertLevel>2</expertLevel>
          </guiDefinition>
          <default>None</default>
          <min>2</min>
        </qualifiers>
      </content>
      <content id="reduction_batch_size">
        <className>CInt</className>
        <qualifiers>
          <guiLabel>Batch size</guiLabel>
          <toolTip>The minimum batch size for consistent reindexing of data with cosym.</toolTip>
          <guiDefinition>
            <expertLevel>2</expertLevel>
          </guiDefinition>
          <default>1000</default>
        </qualifiers>
      </content>
      <content id="reference">
        <className>CDataFile</className>
        <qualifiers>
          <guiLabel>Reference model or intensities</guiLabel>
          <toolTip>A reference to use for scaling + indexing ambiguity resolution. Can be a model pdb/cif file or a cif/mtz data file contaning intensity information.</toolTip>
          <saveToDb>True</saveToDb>
          <guiDefinition>
            <expertLevel>1</expertLevel>
          </guiDefinition>
        </qualifiers>
      </content>
      <content id="partiality_threshold">
        <className>CFloat</className>
        <qualifiers>
          <guiLabel>Partiality threshold</guiLabel>
          <toolTip>Filter out reflections below this partiality in data reduction.</toolTip>
          <guiDefinition/>
          <default>0.25</default>
        </qualifiers>
      </content>
      <container id="reference_model">
        <qualifiers>
          <guiDefinition/>
        </qualifiers>
        <content id="reference_model__k_sol">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>k_sol</guiLabel>
            <toolTip>Average solvent density to use when calculating the bulk solvent contribution to the structure factors from a structural model. See Fokine and Urzhumtsev, Acta Cryst. (2002). D58, 1387-1392 for further details on the meaning of this parameter.</toolTip>
            <guiDefinition>
              <expertLevel>3</expertLevel>
            </guiDefinition>
            <default>0.35</default>
          </qualifiers>
        </content>
        <content id="reference_model__b_sol">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>b_sol</guiLabel>
            <toolTip>Average solvent B-factor to use when calculating the bulk solvent contribution to the structure factors from a structural model. See Fokine and Urzhumtsev, Acta Cryst. (2002). D58, 1387-1392 for further details on the meaning of this parameter.</toolTip>
            <guiDefinition>
              <expertLevel>3</expertLevel>
            </guiDefinition>
            <default>46.0</default>
          </qualifiers>
        </content>
      </container>
      <container id="clustering">
        <qualifiers>
          <guiLabel>Clustering</guiLabel>
          <guiDefinition/>
        </qualifiers>
        <content id="clustering__threshold">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>Threshold</guiLabel>
            <toolTip>If no data has previously been reduced, then unit cell clustering is performed. This threshold is the value at which the dendrogram will be split in dials.cluster_unit_cell (the default value there is 5000). A higher threshold value means that unit cells with greater differences will be retained. Only the largest cluster obtained from cutting at this threshold is used for data reduction. Setting the threshold to None/0 will skip this unit cell clustering and proceed to filtering based on the absolute angle/length tolerances.</toolTip>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
            <default>None</default>
            <min>0</min>
          </qualifiers>
        </content>
        <content id="clustering__absolute_angle_tolerance">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>Absolute angle tolerance</guiLabel>
            <toolTip>Filter the integrated data based on the median unit cell angles and this tolerance. If set to None/0, filtering will be skipped.</toolTip>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
            <default>1.0</default>
            <min>0</min>
          </qualifiers>
        </content>
        <content id="clustering__absolute_length_tolerance">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>Absolute length tolerance</guiLabel>
            <toolTip>Filters the integrated data based on the median unit cell lengths and this tolerance. If set to None/0, filtering will be skipped.</toolTip>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
            <default>1.0</default>
            <min>0</min>
          </qualifiers>
        </content>
        <content id="clustering__central_unit_cell">
          <className>CString</className>
          <qualifiers>
            <guiLabel>Central unit cell</guiLabel>
            <toolTip>Filter the integrated data based on the tolerances about these cell parameters, rather than the median cell.</toolTip>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
          </qualifiers>
        </content>
      </container>
      <container id="symmetry">
        <qualifiers>
          <guiLabel>Symmetry</guiLabel>
          <guiDefinition/>
        </qualifiers>
        <content id="symmetry__lattice_symmetry_max_delta">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>Tolerance for lattice symmetry analysis</guiLabel>
            <toolTip>Tolerance for lattice symmetry analysis, used for example when determining possible symmetries for ambiguity resolution.</toolTip>
            <guiDefinition>
              <expertLevel>3</expertLevel>
            </guiDefinition>
            <default>0.5</default>
          </qualifiers>
        </content>
        <content id="symmetry__phil">
          <className>CDataFile</className>
          <qualifiers>
            <guiLabel>Phil options file for dials.cosym</guiLabel>
            <toolTip>Phil options file to use for symmetry analysis with dials.cosym.  Parameters defined in the xia2.ssx phil scope will take precedent over identical options defined in the phil file.</toolTip>
            <guiDefinition>
              <expertLevel>3</expertLevel>
            </guiDefinition>
          </qualifiers>
        </content>
        <content id="symmetry__space_group">
          <className>CSpaceGroup</className>
          <qualifiers>
            <guiLabel>Space group</guiLabel>
            <guiDefinition>
              <expertLevel>2</expertLevel>
            </guiDefinition>
          </qualifiers>
        </content>
      </container>
      <container id="scaling">
        <qualifiers>
          <guiLabel>Scaling</guiLabel>
          <guiDefinition/>
        </qualifiers>
        <content id="scaling__anomalous">
          <className>CBoolean</className>
          <qualifiers>
            <guiLabel>Anomalous</guiLabel>
            <toolTip>If True, keep anomalous pairs separate during scaling.</toolTip>
            <guiDefinition>
              <expertLevel>1</expertLevel>
            </guiDefinition>
            <default>False</default>
          </qualifiers>
        </content>
        <content id="scaling__phil">
          <className>CDataFile</className>
          <qualifiers>
            <guiLabel>Phil options file for dials.scale</guiLabel>
            <toolTip>Phil options file to use for dials.scale.  Parameters defined in the xia2.ssx phil scope will take precedent over identical options defined in the phil file.</toolTip>
            <guiDefinition>
              <expertLevel>3</expertLevel>
            </guiDefinition>
          </qualifiers>
        </content>
      </container>
      <container id="filtering">
        <qualifiers>
          <guiDefinition/>
        </qualifiers>
        <content id="filtering__mean_i_over_sigma_threshold">
          <className>CFloat</className>
          <qualifiers>
            <guiLabel>I/sigma threshold</guiLabel>
            <guiDefinition>
              <expertLevel>1</expertLevel>
              <toolTip>Apply a per-image mean I/sigma filter, calculated on reflections with partialities above the partiality_threshold.</toolTip>
            </guiDefinition>
            <default>None</default>
          </qualifiers>
        </content>
      </container>
    </container>
  </ccp4i2_body>
</ccp4i2>
